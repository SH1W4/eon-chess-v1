<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ§ª Teste Simples da Base de Dados</title>
    <style>
        body {
            background: #171717;
            color: white;
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
        }

        .test-container {
            max-width: 800px;
            margin: 0 auto;
            background: #1a1a1a;
            padding: 20px;
            border-radius: 10px;
            border: 1px solid #333;
        }

        .status {
            padding: 10px;
            margin: 10px 0;
            border-radius: 5px;
            font-family: monospace;
        }

        .status.success {
            background: #004400;
            border: 1px solid #00ff00;
        }

        .status.error {
            background: #440000;
            border: 1px solid #ff0000;
        }

        .status.info {
            background: #004444;
            border: 1px solid #00ffff;
        }
    </style>
</head>

<body>
    <div class="test-container">
        <h1>ğŸ§ª Teste Simples da Base de Dados</h1>

        <div id="test-results">
            <div class="status info">Aguardando teste...</div>
        </div>

        <div id="console-output" class="status info" style="margin-top: 20px;">
            <strong>Console Output:</strong><br>
            <div id="console-content">Aguardando...</div>
        </div>
    </div>

    <!-- Carregar apenas a base de dados -->
    <script src="js/chess-pro-database.js"></script>

    <script>
        // FunÃ§Ã£o para adicionar output ao console visual
        function addConsoleOutput(message, type = 'info') {
            const consoleContent = document.getElementById('console-content');
            const timestamp = new Date().toLocaleTimeString();
            const outputLine = document.createElement('div');
            outputLine.innerHTML = `[${timestamp}] ${message}`;
            consoleContent.appendChild(outputLine);
        }

        // FunÃ§Ã£o para atualizar resultados
        function updateResults(message, type = 'info') {
            const resultsDiv = document.getElementById('test-results');
            resultsDiv.innerHTML = `<div class="status ${type}">${message}</div>`;
        }

        // Teste principal
        function runTest() {
            console.log('ğŸ§ª Iniciando teste da base de dados...');
            addConsoleOutput('ğŸ§ª Iniciando teste da base de dados...');

            try {
                // Verificar se a classe existe
                if (typeof ChessProDatabase === 'undefined') {
                    throw new Error('Classe ChessProDatabase nÃ£o encontrada');
                }
                console.log('âœ… Classe ChessProDatabase encontrada');
                addConsoleOutput('âœ… Classe ChessProDatabase encontrada');

                // Verificar se foi adicionada ao window
                if (typeof window.ChessProDatabase === 'undefined') {
                    throw new Error('Classe nÃ£o foi adicionada ao window');
                }
                console.log('âœ… Classe adicionada ao window');
                addConsoleOutput('âœ… Classe adicionada ao window');

                // Verificar se a instÃ¢ncia foi criada
                if (typeof window.chessProDB === 'undefined') {
                    throw new Error('InstÃ¢ncia chessProDB nÃ£o foi criada');
                }
                console.log('âœ… InstÃ¢ncia chessProDB criada');
                addConsoleOutput('âœ… InstÃ¢ncia chessProDB criada');

                // Verificar se a instÃ¢ncia tem os mÃ©todos necessÃ¡rios
                if (typeof window.chessProDB.getStatistics !== 'function') {
                    throw new Error('MÃ©todo getStatistics nÃ£o encontrado');
                }
                console.log('âœ… MÃ©todo getStatistics encontrado');
                addConsoleOutput('âœ… MÃ©todo getStatistics encontrado');

                // Testar o mÃ©todo getStatistics
                const stats = window.chessProDB.getStatistics();
                console.log('ğŸ“Š EstatÃ­sticas obtidas:', stats);
                addConsoleOutput(`ğŸ“Š EstatÃ­sticas obtidas: ${JSON.stringify(stats)}`);

                // Verificar se as estatÃ­sticas fazem sentido
                if (stats.totalPositions <= 0) {
                    throw new Error('Total de posiÃ§Ãµes invÃ¡lido');
                }
                console.log('âœ… Total de posiÃ§Ãµes vÃ¡lido:', stats.totalPositions);
                addConsoleOutput(`âœ… Total de posiÃ§Ãµes vÃ¡lido: ${stats.totalPositions}`);

                // Sucesso
                updateResults(`
                    <strong>âœ… Base de Dados Funcionando!</strong><br>
                    Total de PosiÃ§Ãµes: ${stats.totalPositions}<br>
                    Categorias: ${stats.totalCategories}<br>
                    Status: Ativa e operacional
                `, 'success');

                console.log('ğŸ‰ Teste concluÃ­do com sucesso!');
                addConsoleOutput('ğŸ‰ Teste concluÃ­do com sucesso!');

            } catch (error) {
                console.error('âŒ Erro no teste:', error);
                addConsoleOutput(`âŒ Erro no teste: ${error.message}`);

                updateResults(`
                    <strong>âŒ Erro na Base de Dados</strong><br>
                    Erro: ${error.message}<br>
                    Stack: ${error.stack}
                `, 'error');
            }
        }

        // Executar teste quando a pÃ¡gina carregar
        document.addEventListener('DOMContentLoaded', function() {
            console.log('ğŸš€ PÃ¡gina carregada, aguardando scripts...');
            addConsoleOutput('ğŸš€ PÃ¡gina carregada, aguardando scripts...');

            // Aguardar um pouco para os scripts carregarem
            setTimeout(() => {
                console.log('ğŸ” Executando teste...');
                addConsoleOutput('ğŸ” Executando teste...');
                runTest();
            }, 1000);
        });

        // VerificaÃ§Ã£o adicional
        window.addEventListener('load', function() {
            console.log('ğŸ“š PÃ¡gina totalmente carregada');
            addConsoleOutput('ğŸ“š PÃ¡gina totalmente carregada');
        });
    </script>
</body>

</html>